"""Tests for taipan.csvloader package."""

from taipan.csvloader import CSVLoader
from csv import QUOTE_MINIMAL

tomtom_csv = """timestamp longitude latitude "speed m/s"
1305093212000 13.587170 52.425710 8.33
1305093213000 13.587030 52.425690 8.33
1305093214000 13.586920 52.425690 8.33
1305093215000 13.586810 52.425660 8.33
1305093216000 13.586730 52.425650 3.89
1305093217000 13.586680 52.425650 3.89
1305093218000 13.586620 52.425640 3.89
1305093219000 13.586580 52.425630 3.89
1305093220000 13.586530 52.425630 3.89
1305093221000 13.586470 52.425630 3.89
1305093222000 13.586370 52.425600 3.89
1305093223000 13.586310 52.425590 3.89
1305093224000 13.586250 52.425580 3.89
1305093225000 13.586200 52.425580 3.89
1305093226000 13.586140 52.425570 3.89
1305093227000 13.586090 52.425640 12.50
1305093228000 13.586040 52.425740 12.50"""

def test_load_csv():
    csv_loader = CSVLoader(delimiter=" ")
    loaded_csv = csv_loader.load_csv(tomtom_csv)
    assert loaded_csv.ndim == 2
    assert loaded_csv.shape == (18, 4)
